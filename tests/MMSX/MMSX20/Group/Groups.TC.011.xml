<test>

	<function name="testName" module="Basic">
		<parameter>Groups.TC.011</parameter>
	</function>

	<description>Validate Groups Use Case does not function when Sender and Recipient are in DB and Sender has "Groups" feature enabled and Specified Group Name in MM does not exist in DB</description>

	<!-- Start MMSC server -->
	<function name="startMMSCServer" module="MMSC"/>

	<!-- Delete Message Store -->
	<subtest>../deleteMessageStoreAll.xml</subtest>

	<!-- Available MSISDN -->
	<configuration>../subscriber_config.xml</configuration>

	<!-- Query the name of the active MESSAGE-STORE process -->
	<function name="activeProcessToVar" module="Remote">
		<parameter>MESSAGE-STORE</parameter>
		<parameter>Message_Store_Process_Name</parameter>
	</function>

	<!-- Set mandatory headers  -->
	<function name="setHeader" module="HTTP">
		<parameter>X-Proxy-Region</parameter>
		<parameter>Siberia</parameter>
	</function>

	<function name="setHeader" module="HTTP">
		<parameter>X-Proxy-Session-Id</parameter>
		<parameter>987654</parameter>
	</function>

	<function name="setHeader" module="HTTP">
		<parameter>X-Proxy-MMS-Message-Type</parameter>
		<parameter>m-send-req</parameter>
	</function>

	<function name="setHeader" module="HTTP">
		<parameter>To</parameter>
		<configuration>MMSX/SHORTCODE/MSISDN4</configuration>
	</function>

	<function name="setHeader" module="HTTP">
		<parameter>X-Proxy-Subscriber-MSISDN</parameter>
		<configuration>MMSX/GROUP/SENDER/MSISDN1</configuration>
	</function>

	<!-- Set Subject for group feature -->
	<function name="setHeader" module="HTTP">
		<parameter>Subject</parameter>
		<parameter>group9006 This is test group message</parameter>
	</function>

	<!-- Send Metadeta  Request to application-->
	<function name="sendGetRequest" module="HTTP">
		<parameter>
			<parameter>http://</parameter>
			<configuration>MMS_Extra/IP</configuration>
			<parameter>:</parameter>
			<configuration>MMS_Extra/port</configuration>
			<parameter>/New-Message-Intercepted</parameter>
		</parameter>
	</function>

	<!-- Check response received from application -->
	<function name="checkResponseCode" module="HTTP">
		<parameter>200</parameter>
	</function>

	<!-- Will get response as New-Message-Intercepted-Response where need to validate X-Proxy-Handle as "discard" due to  Sender is in DB -->
	<function name="checkHeader" module="HTTP">
		<parameter>X-Proxy-Handle</parameter>
		<parameter>discard</parameter>
	</function>

	<!--validate x-mms-response-status as "Error-service-denied" due to Sender do not have "Groups" feature enabled -->
	<function name="checkHeader" module="HTTP">
		<parameter>x-mms-response-status-code</parameter>
		<parameter>Error-service-denied</parameter>
	</function>

	<!-- validate x-mms-response-text as "group is unknown" due to Group Name in MM does not exist in DB -->
	<function name="checkHeader" module="HTTP">
		<parameter>x-mms-response-status-text</parameter>
		<parameter>MMSX: Message to a group rejected because you have not configured the specified group.</parameter>
	</function>

	<!-- Check for MMS message stored in Message Store-->
	<function name="executeRemoteXMSCommand" module="Remote">
		<parameter>
			<parameter>run command amocli -k count TI:F.CEE.</parameter>
			<variable>Message_Store_Process_Name</variable>
			<parameter>:AMO</parameter>
		</parameter>
	</function>

	<function name="queryResponse" module="Remote">
		<parameter>amocli: 0 items counted</parameter>
		<parameter>response</parameter>
	</function>

	<!-- Stop MMSC Server -->
	<function name="stopMMSCServer" module="MMSC"/>

</test>